#summary How to enable the emulator talk with a SIM card connected through PC/SC

= Introduction =

The Android emulator is only supporting a primitive 'fake' SIM card it cannot be used to extend the Sim Toolkit framework. On real devices, the RIL library is very restrictive in terms of STK support.<br/>
This patch enables the Android emulator to forward any APDU traffic (AT+CRSM commands) to a real SIM card that is connected through a PC/SC card reader and accessible with pcsc-lite.
<br/><br/>


== Applying the patch to the emulator sources ==

  * Download the [http://seek-for-android.googlecode.com/files/20100304_emulator_donut.patch patch]
  * Apply the patch in the root folder of the source tree: <code>patch -p1 < 20100304_emulator_donut.patch</code>
  * Download and build pcsc-lite: <code>./configure; make</code>
  * Rebuild the emulator with PC/SC support: <code>PCSCLITE_PATH=<path/to/pcsc-lite> make -j5</code>
  * Create and AVD and launch the emulator:<code>ANDROID_SDK_ROOT=<path/to/android-sdk-linux> ./out/host/linux-x86/bin/emulator -avd Android_1.6 -system out/target/product/generic/system.img</code>
  * In the radio debug a card reader will get listed, e.g. _sim_card.c: OmniKey CardMan 3121 00 00_
  * If a SIM Toolkit application is located on the SIM card, the Android Stk application can be used to test/debug the card applet.