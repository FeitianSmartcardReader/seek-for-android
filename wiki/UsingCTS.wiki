= Introduction =

The [http://source.android.com/compatibility/cts-intro.html Compatibility Test Suite (CTS)] can be extended so it can be used also to test the Open Mobile API (Smartcard API 2.X).

All test cases for testing the Open Mobile API are contained in a test plan called '!OpenMobile'.

The tests include and utilize a mock plug-in reader that simulates a secure element with an appropriate applet. So the tests can be executed without a real card.

The following paragraphs describe
  * how to build an extended CTS containing the additional Smartcard API and Open Mobile API tests,
  * how to run the tests, and
  * where to find documentation and results of the tests.

= How to Build the CTS =

For building CTS with Smartcard API and Open Mobile API tests
  * change into directory of Android build with Open Mobile API
  * extract file {{{smartcard-api-2_2_2/cts/cts.patch}}} from archive {{{smartcard-api-2_2_2.tgz}}} ([http://seek-for-android.googlecode.com/files/smartcard-api-2_2_2.tgz download]) and apply it as patch and
  * build the CTS:

{{{
$ cd ANDROID_ROOT_DIR
$ tar -xOf PATH_TO_PATCH_ARCHIVE/smartcard-api-2_2_2.tgz smartcard-api-2_2_2/cts/cts.patch | patch -p1 
$ make cts
}}}

Note: In case the shared library version of the Smartcard API/Open Mobile API is used (archive {{{smartcard-api_sharedlibrary-2_2_2.tgz}}}) also the {{{cts.patch}}} of that archive has to be used for the CTS build. 

= How to Run the CTS Tests =
After the CTS has been built successfully with the Open Mobile API
test extensions, the test tool {{{startcts}}} can be found in directory
{{{out/host/linux-x86/cts/android-cts/tools}}}.<br>
So change into that directory:
{{{
$ cd ANDROID_ROOT_DIR/out/host/linux-x86/cts/android-cts/tools
}}}

Execution of the whole test plan for the Open Mobile API is started by the following command: 
{{{
$ ./startcts start --plan OpenMobile
}}}

It is also possible to execute only a part of a test plan.<br>
E.g. to execute only tests of test case {{{TestConformanceRequirements}}} use the following command: 
{{{
$ ./startcts start --plan OpenMobile -p org.simalliance.openmobileapi.cts.TestConformanceRequirements
}}}
= Documentation and Results of CTS Tests = 

The documentation of the test cases of the test plans for the Smartcard API and the Open Mobile API are located in<br>
{{{out/host/linux-x86/cts/android-cts/repository/testcases/CtsOpenMobileTestCases.xml}}}

The results of test runs are stored in directory<br>
{{{out/host/linux-x86/cts/android-cts/repository/results}}}. 

Sample result files of a test run of this test plan can be downloaded [http://seek-for-android.googlecode.com/files/CTS_results-2_2_2.tgz here].
<br><br>

= CTS extension for !SmarcardClient (!SmartCard API 1.X)  =

The [http://source.android.com/compatibility/cts-intro.html Compatibility Test Suite (CTS)] can be extended so it can be used also to test the Smartcard API (API V1.X).

All test cases for testing the !Smartcard API (API V1.X) are contained in a test plan called 'Smartcard'.<br>

The tests include and utilize a mock plug-in reader that simulates a secure element with an appropriate applet. So the tests can be executed without a real card.

The following paragraphs describe
  * how to build an extended CTS containing the additional Smartcard API and Open Mobile API tests,
  * how to run the tests, and
  * where to find documentation and results of the tests.

== How to Build the CTS for !SmarcardClient (API 1.X) ==

For building CTS with Smartcard API (V1.X) tests
  * change into directory of Android build with Smartcard API
  * extract file {{{smartcard-api-2_2_2_api_addon/cts/cts_api_addon.patch}}} from archive {{{smartcard-api-2_2_2_api_addon.tgz}}} ([http://seek-for-android.googlecode.com/files/smartcard-api-2_2_2_api_addon.tgz download]) and apply it as patch and
  * build the CTS:

{{{
$ cd ANDROID_ROOT_DIR
$ tar -xOf PATH_TO_PATCH_ARCHIVE/smartcard-api-2_2_2_api_addon.tgz smartcard-api-2_2_2_api_addon/cts/cts.patch | patch -p1 
$ make cts
}}}

== How to Run the CTS for !SmarcardClient (API 1.X)  ==
After the CTS has been built successfully with the Smartcard API
test extensions, the test tool {{{startcts}}} can be found in directory
{{{out/host/linux-x86/cts/android-cts/tools}}}.<br>
So change into that directory:
{{{
$ cd ANDROID_ROOT_DIR/out/host/linux-x86/cts/android-cts/tools
}}}

Execution of the whole test plan for the Smartcard API is started by the following command: 
{{{
$ ./startcts start --plan Smartcard
}}}


== Documentation and Results of CTS Tests for !SmarcardClient (API 1.X)== 

The documentation of the test cases of the test plans for the Smartcard API and the Open Mobile API are located in<br>
{{{out/host/linux-x86/cts/android-cts/repository/testcases/CtsSmartcardTestCases.xml}}}

The results of test runs are stored in directory<br>
{{{out/host/linux-x86/cts/android-cts/repository/results}}}. 

Sample result files of a test run of this test plan can be downloaded [http://seek-for-android.googlecode.com/files/CTS_results-2_2_2.tgz here].
  