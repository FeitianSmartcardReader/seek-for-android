#summary How to build and flash a Mobile Commerce Extension (Mc-EX) enabled kernel for the Nexus One

= !!! Temporarily unavailable !!! =
== How to build and flash a Mobile Commerce Extension (Mc-EX) enabled kernel for the Nexus One ==
This description has been tested with a Google Nexus One.

=== Get the kernel sources ===
Download the kernel sources for the Nexus One as follows: 
{{{
git clone git://android.git.kernel.org/kernel/msm.git
git checkout origin/android-msm-2.6.29-nexusone
git checkout -b android-msm-2.6.29-nexusone
}}}

=== Get the kernel configuration file ===
Setup the kernel configuration as follows:
{{{
make ARCH=arm CROSS_COMPILE=arm-eabi- defconfig mahimahi_defconfig
}}}

=== Build your own kernel ===
Build the kernel as follows:
{{{
make ARCH=arm CROSS_COMPILE=arm-eabi-
}}}

=== Download and apply the Mc-EX patch ===
Apply the Mc-EX patch and rebuilt the kernel as described above. A short description on how to apply the patch can be found inside the [http://seek-for-android.googlecode.com/files/20091023_mcexdrv.tar.bz2 archive].

=== Build your own initrd ===
Get the prebuilt kernel and initrd of your device using a nandroid enabled recovery image after creating a device backup(_/sdcard/nandroid/.../boot.img_). The Internet contains a lot of information on how to do this.
Get [http://android-serialport-api.googlecode.com/files/getramdisk.py this] script and extract the contents of the prebuilt initrd as follows:
{{{
cd <mynexusone>
<mydownloads>/getramdisk.py <mydownloads>/boot.img
mkdir <mynexusone>/initrd
cd <mynexusone>/initrd
gunzip < <mynexusone>/ramdisk.img | cpio --extract --preserve --verbose
}}}

Download, patch and build the Android system as described [http://code.google.com/p/seek-for-android/wiki/HowToBuildKernel here].

Enter your "`<mynexusone>/initrd`" directory, replace the Android init and build your own boot.img as follows:
{{{
cp <mydroid>/out/target/product/dream-open/root/init init
find . | cpio --create --'format=newc' | gzip > <mynexusone>/initrd.img
mkbootimg --kernel <mykernel>/arch/arm/boot/zImage --ramdisk <mynexusone>/initrd.img --base 0x20000000 -o <mynexusone>/boot.img
}}}

=== Flash your own kernel ===
*Backup the Android system of your device before you do this last step.*
{{{
fastboot flash boot <mynexusone>/boot.img
}}}